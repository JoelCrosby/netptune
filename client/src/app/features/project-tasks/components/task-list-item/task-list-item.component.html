<div class="task-item" [class.flagged]="task.isFlagged">
  <button
    class="task-action"
    mat-icon-button
    aria-label="more"
    [matMenuTriggerData]="{ task: task }"
    [matMenuTriggerFor]="menu"
  >
    <mat-icon class="drag"> more_vert </mat-icon>
  </button>

  <mat-checkbox class="task-checkbox" color="primary"> </mat-checkbox>

  <div class="task-scope-id-col">
    <div class="task-scope-id">{{ task.systemId }}</div>
  </div>

  <div class="title" (click)="titleClicked()">{{ task.name }}</div>

  <mat-icon *ngIf="task.isFlagged" color="warn" class="flag"> flag </mat-icon>

  <mat-icon class="task-complete" *ngIf="task.status === 1"> done </mat-icon>

  <app-avatar
    *ngFor="let assignee of task.assignees"
    size="24"
    class="task-card-user-chip"
    [name]="assignee.displayName"
    [imageUrl]="assignee.pictureUrl"
  >
  </app-avatar>
</div>

<mat-menu #menu="matMenu">
  <ng-template matMenuContent let-task="task">
    <button mat-menu-item (click)="markCompleteClicked(task)">
      <mat-icon class="material-icons-outlined"> done </mat-icon>
      <span>Mark Complete</span>
    </button>

    <button mat-menu-item (click)="moveToBacklogClicked(task)">
      <mat-icon class="material-icons-outlined">
        assignment_returned_outline
      </mat-icon>
      <span>Move to Backlog</span>
    </button>

    <button mat-menu-item (click)="deleteClicked(task)">
      <mat-icon class="material-icons-outlined"> delete </mat-icon>
      <span>Delete</span>
    </button>
  </ng-template>
</mat-menu>
